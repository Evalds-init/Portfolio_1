{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Evalds\\\\Documents\\\\Portfolio_1\\\\client\\\\src\\\\context\\\\basket\\\\basketState.js\";\nimport { ADD_TO_BASKET, GET_BASKET, DELETE_BASKET_ITEM, CREATE_CHECKOUT_SESSION, EDIT_QUANTITY, BASKET_ERROR } from '../types';\nimport React, { useReducer } from 'react';\nimport BasketContext from './basketContext';\nimport basketReducer from './basketReducer';\nimport axios from 'axios';\naxios.defaults.withCredentials = true;\n\nconst BasketState = props => {\n  const initialState = {\n    basket: null,\n    sessionId: null,\n    error: null\n  };\n  const [state, dispatch] = useReducer(basketReducer, initialState); //Add item to basket\n\n  const addToBasket = async (product, quantity) => {\n    let item = {\n      product: product._id,\n      quantity\n    };\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n\n    try {\n      await axios.put(`/api/v1/basket/${product._id}/addtobasket`, item, config);\n      dispatch({\n        type: ADD_TO_BASKET,\n        payload: product\n      });\n    } catch (error) {\n      dispatch({\n        type: BASKET_ERROR,\n        payload: error.response.data\n      });\n    }\n  }; //Get basket items\n\n\n  const getBasketItems = async () => {\n    try {\n      const res = await axios.get(`/api/v1/basket/getitems`);\n      dispatch({\n        type: GET_BASKET,\n        payload: res.data.data\n      });\n    } catch (error) {\n      dispatch({\n        type: BASKET_ERROR,\n        payload: error.response.data\n      });\n    }\n  }; //Update basket item quantity\n\n\n  const updateQuan = async () => {\n    try {\n      const res = await axios.get(`/api/v1/basket/getitems`);\n      dispatch({\n        type: GET_BASKET,\n        payload: res.data.data\n      });\n    } catch (error) {\n      dispatch({\n        type: BASKET_ERROR,\n        payload: error.response.data\n      });\n    }\n  }; //Delete item from basket\n\n\n  const deleteBasketItem = async id => {\n    try {\n      await axios.delete(`/api/v1/basket/deleteitem/${id}`);\n      dispatch({\n        type: DELETE_BASKET_ITEM,\n        payload: id\n      });\n    } catch (error) {\n      dispatch({\n        type: BASKET_ERROR,\n        payload: error.response.data\n      });\n    }\n  }; //Create stripe checkout session\n\n\n  const createCheckoutSession = async id => {\n    try {\n      const res = await axios.post('/api/v1/basket/create-checkout-session');\n      dispatch({\n        type: CREATE_CHECKOUT_SESSION,\n        payload: res.data.id\n      });\n    } catch (error) {\n      dispatch({\n        type: BASKET_ERROR,\n        payload: error.response.data\n      });\n    }\n  }; // Edit purchase quantity\n\n\n  const editQuantity = async (id, quantity) => {\n    try {\n      const res = await axios.post('/api/v1/basket/editquantity');\n      dispatch({\n        type: EDIT_QUANTITY,\n        payload: id,\n        quantity\n      });\n    } catch (error) {\n      dispatch({\n        type: BASKET_ERROR,\n        payload: error.response.data\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(BasketContext.Provider, {\n    value: {\n      basket: state.basket,\n      sessionId: state.sessionId,\n      addToBasket,\n      getBasketItems,\n      deleteBasketItem,\n      createCheckoutSession\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 5\n    }\n  }, props.children);\n};\n\nexport default BasketState;","map":{"version":3,"sources":["C:/Users/Evalds/Documents/Portfolio_1/client/src/context/basket/basketState.js"],"names":["ADD_TO_BASKET","GET_BASKET","DELETE_BASKET_ITEM","CREATE_CHECKOUT_SESSION","EDIT_QUANTITY","BASKET_ERROR","React","useReducer","BasketContext","basketReducer","axios","defaults","withCredentials","BasketState","props","initialState","basket","sessionId","error","state","dispatch","addToBasket","product","quantity","item","_id","config","headers","put","type","payload","response","data","getBasketItems","res","get","updateQuan","deleteBasketItem","id","delete","createCheckoutSession","post","editQuantity","children"],"mappings":"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","sourcesContent":["import {\r\n  ADD_TO_BASKET,\r\n  GET_BASKET,\r\n  DELETE_BASKET_ITEM,\r\n  CREATE_CHECKOUT_SESSION,\r\n  EDIT_QUANTITY,\r\n  BASKET_ERROR,\r\n} from '../types';\r\nimport React, { useReducer } from 'react';\r\nimport BasketContext from './basketContext';\r\nimport basketReducer from './basketReducer';\r\nimport axios from 'axios';\r\naxios.defaults.withCredentials = true;\r\n\r\nconst BasketState = (props) => {\r\n  const initialState = {\r\n    basket: null,\r\n    sessionId: null,\r\n    error: null,\r\n  };\r\n\r\n  const [state, dispatch] = useReducer(basketReducer, initialState);\r\n  //Add item to basket\r\n  const addToBasket = async (product, quantity) => {\r\n    let item = {\r\n      product: product._id,\r\n      quantity,\r\n    };\r\n    const config = {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    };\r\n\r\n    try {\r\n      await axios.put(\r\n        `/api/v1/basket/${product._id}/addtobasket`,\r\n        item,\r\n        config\r\n      );\r\n\r\n      dispatch({ type: ADD_TO_BASKET, payload: product });\r\n    } catch (error) {\r\n      dispatch({ type: BASKET_ERROR, payload: error.response.data });\r\n    }\r\n  };\r\n  //Get basket items\r\n  const getBasketItems = async () => {\r\n    try {\r\n      const res = await axios.get(`/api/v1/basket/getitems`);\r\n\r\n      dispatch({ type: GET_BASKET, payload: res.data.data });\r\n    } catch (error) {\r\n      dispatch({ type: BASKET_ERROR, payload: error.response.data });\r\n    }\r\n  };\r\n  //Update basket item quantity\r\n  const updateQuan = async () => {\r\n    try {\r\n      const res = await axios.get(`/api/v1/basket/getitems`);\r\n\r\n      dispatch({ type: GET_BASKET, payload: res.data.data });\r\n    } catch (error) {\r\n      dispatch({ type: BASKET_ERROR, payload: error.response.data });\r\n    }\r\n  };\r\n  //Delete item from basket\r\n  const deleteBasketItem = async (id) => {\r\n    try {\r\n      await axios.delete(`/api/v1/basket/deleteitem/${id}`);\r\n      dispatch({ type: DELETE_BASKET_ITEM, payload: id });\r\n    } catch (error) {\r\n      dispatch({ type: BASKET_ERROR, payload: error.response.data });\r\n    }\r\n  };\r\n  //Create stripe checkout session\r\n  const createCheckoutSession = async (id) => {\r\n    try {\r\n      const res = await axios.post('/api/v1/basket/create-checkout-session');\r\n      dispatch({ type: CREATE_CHECKOUT_SESSION, payload: res.data.id });\r\n    } catch (error) {\r\n      dispatch({ type: BASKET_ERROR, payload: error.response.data });\r\n    }\r\n  };\r\n  // Edit purchase quantity\r\n  const editQuantity = async (id, quantity) => {\r\n    try {\r\n      const res = await axios.post('/api/v1/basket/editquantity');\r\n      dispatch({ type: EDIT_QUANTITY, payload: id, quantity });\r\n    } catch (error) {\r\n      dispatch({ type: BASKET_ERROR, payload: error.response.data });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <BasketContext.Provider\r\n      value={{\r\n        basket: state.basket,\r\n        sessionId: state.sessionId,\r\n        addToBasket,\r\n        getBasketItems,\r\n        deleteBasketItem,\r\n        createCheckoutSession,\r\n      }}\r\n    >\r\n      {props.children}\r\n    </BasketContext.Provider>\r\n  );\r\n};\r\n\r\nexport default BasketState;\r\n"]},"metadata":{},"sourceType":"module"}